<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logistics Dashboard - Business Hub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0 2rem;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            background: #4f46e5;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .time-info {
            text-align: right;
            font-size: 12px;
            color: #64748b;
        }

        .notification-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #e2e8f0;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
        }

        .user-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }

        .user-avatar {
            width: 24px;
            height: 24px;
            background: #ef4444;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        /* Main Layout */
        .main-layout {
            display: flex;
            min-height: calc(100vh - 70px);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid #e2e8f0;
            padding: 2rem 1.5rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-title {
            color: #94a3b8;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.75rem;
            padding-left: 0.5rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            margin: 2px 0;
            border-radius: 8px;
            color: #475569;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .nav-item:hover {
            background: #f1f5f9;
            color: #334155;
        }

        .nav-item.active {
            background: #fef3c7;
            color: #92400e;
            border-color: #f59e0b;
        }

        .nav-icon {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            background: #e2e8f0;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #64748b;
            flex-shrink: 0;
        }

        .nav-item.active .nav-icon {
            background: #f59e0b;
            color: white;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 2rem;
            background: #f8fafc;
        }

        .content-header {
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: #64748b;
            font-size: 1rem;
        }

        .logistics-layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 2rem;
            height: calc(100vh - 200px);
        }

        /* Search Panel */
        .search-panel {
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .search-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
        }

        .search-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .search-input:focus {
            border-color: #4f46e5;
        }

        .product-list {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .product-item {
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 8px;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .product-item:hover {
            background: #f1f5f9;
            border-color: #e2e8f0;
        }

        .product-item.active {
            background: #eff6ff;
            border-color: #3b82f6;
        }

        .product-name {
            font-weight: 500;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .product-category {
            font-size: 12px;
            color: #64748b;
        }

        .product-suppliers {
            font-size: 12px;
            color: #10b981;
            font-weight: 500;
        }

        /* Map Container */
        .map-container {
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            overflow: hidden;
            position: relative;
        }

        .map-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .map-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
        }

        .map-filters {
            display: flex;
            gap: 0.5rem;
        }

        .filter-btn {
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            background: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-btn.active {
            background: #4f46e5;
            color: white;
            border-color: #4f46e5;
        }

        .map-viewport {
            height: 500px;
            position: relative;
        }

        /* Supplier Details Panel */
        .supplier-details {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 300px;
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            transform: translateX(320px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .supplier-details.active {
            transform: translateX(0);
        }

        .supplier-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .supplier-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
        }

        .close-details {
            background: none;
            border: none;
            color: #64748b;
            cursor: pointer;
            font-size: 18px;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .supplier-info {
            margin-bottom: 1rem;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .info-label {
            color: #64748b;
        }

        .info-value {
            color: #1e293b;
            font-weight: 500;
        }

        .rating {
            display: flex;
            gap: 2px;
        }

        .star {
            color: #fbbf24;
        }

        .products-supplied {
            margin-top: 1rem;
        }

        .products-title {
            font-size: 14px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .product-tag {
            display: inline-block;
            background: #f1f5f9;
            color: #475569;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin: 2px 4px 2px 0;
        }

        .contact-btn {
            width: 100%;
            background: #4f46e5;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s ease;
            margin-top: 1rem;
        }

        .contact-btn:hover {
            background: #4338ca;
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 14px;
            color: #64748b;
        }

        /* Custom Leaflet Popup Styles */
        .leaflet-popup-content-wrapper {
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        .supplier-popup {
            min-width: 200px;
        }

        .popup-header {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .popup-info {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 4px;
        }

        .popup-rating {
            color: #f59e0b;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .popup-btn {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 8px;
        }

        /* Advanced Filtering */
        .advanced-filters {
            margin-top: 1rem;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 8px;
        }

        .filter-group {
            margin-bottom: 1rem;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
            display: block;
        }

        .filter-select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .filter-range {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .range-input {
            flex: 1;
            padding: 6px 8px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 12px;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .logistics-layout {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr;
                height: auto;
            }

            .search-panel {
                height: 300px;
            }

            .supplier-details {
                position: relative;
                top: 0;
                right: 0;
                width: 100%;
                transform: none;
                margin-top: 1rem;
            }
        }

        @media (max-width: 768px) {
            .main-layout {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                padding: 1rem;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
            }

            .main-content {
                padding: 1rem;
            }

            .stats-bar {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <div class="header">
        <div class="logo">B</div>
        <div class="header-right">
            <div class="time-info">
                <div>Philippine Standard Time</div>
                <div id="current-time">Friday, June 20, 2025, 9:29:45 AM</div>
            </div>
            <button class="notification-btn">üîî</button>
            <button class="user-btn">
                <div class="user-avatar">üë§</div>
                <span>User</span>
                <span>‚ñº</span>
            </button>
        </div>
    </div>

    <div class="main-layout">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="nav-section">
                <div class="nav-title">Home</div>
                <a href="#" class="nav-item" data-page="dashboard">
                    <div class="nav-icon">üìä</div>
                    Dashboard
                </a>
            </div>

            <div class="nav-section">
                <a href="inventory.html" class="nav-item" data-page="inventory">
                    <div class="nav-icon">üì¶</div>
                    Inventory Management
                </a>
                <a href="payroll.html" class="nav-item" data-page="payroll">
                    <div class="nav-icon">üí∞</div>
                    Payroll
                </a>
                <a href="expenses.php" class="nav-item" data-page="expenses">
                    <div class="nav-icon">üìà</div>
                    Expense Tracker
                </a>
                <a href="support.html" class="nav-item" data-page="support">
                    <div class="nav-icon">üí¨</div>
                    Communication & Support
                </a>
                <a href="logistics.html" class="nav-item active">
                    <div class="nav-icon">üöö</div>
                    Logistics & Suppliers
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="content-header">
                <h1 class="page-title">üöö Logistics & Supplier Management - Visayas</h1>
                <p class="page-subtitle">Find and manage suppliers for raw materials and products across the Visayas region</p>
            </div>

            <div class="stats-bar">
                <div class="stat-card">
                    <div class="stat-value">89</div>
                    <div class="stat-label">Visayas Suppliers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">28</div>
                    <div class="stat-label">Product Categories</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">92%</div>
                    <div class="stat-label">On-Time Delivery</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">‚Ç±1.8M</div>
                    <div class="stat-label">Monthly Orders</div>
                </div>
            </div>

            <div class="logistics-layout">
                <!-- Search Panel -->
                <div class="search-panel">
                    <div class="search-header">
                        <div class="search-title">Search Raw Materials</div>
                        <input type="text" class="search-input" id="productSearch"
                            placeholder="Search for raw materials...">
                    </div>
                    
                    <!-- Advanced Filters -->
                    <div class="advanced-filters">
                        <div class="filter-group">
                            <label class="filter-label">Province</label>
                            <select class="filter-select" id="provinceFilter">
                                <option value="">All Provinces</option>
                                <option value="Cebu">Cebu</option>
                                <option value="Bohol">Bohol</option>
                                <option value="Negros Oriental">Negros Oriental</option>
                                <option value="Siquijor">Siquijor</option>
                                <option value="Negros Occidental">Negros Occidental</option>
                                <option value="Iloilo">Iloilo</option>
                                <option value="Aklan">Aklan</option>
                                <option value="Antique">Antique</option>
                                <option value="Capiz">Capiz</option>
                                <option value="Guimaras">Guimaras</option>
                                <option value="Leyte">Leyte</option>
                                <option value="Southern Leyte">Southern Leyte</option>
                                <option value="Samar">Samar</option>
                                <option value="Eastern Samar">Eastern Samar</option>
                                <option value="Northern Samar">Northern Samar</option>
                                <option value="Biliran">Biliran</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label">Minimum Rating</label>
                            <select class="filter-select" id="ratingFilter">
                                <option value="">Any Rating</option>
                                <option value="4.5">4.5+ Stars</option>
                                <option value="4.0">4.0+ Stars</option>
                                <option value="3.5">3.5+ Stars</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label">Lead Time (days)</label>
                            <div class="filter-range">
                                <input type="number" class="range-input" id="minLeadTime" placeholder="Min" min="1" max="30">
                                <span>-</span>
                                <input type="number" class="range-input" id="maxLeadTime" placeholder="Max" min="1" max="30">
                            </div>
                        </div>
                    </div>
                    
                    <div class="product-list" id="productList">
                        <!-- Products will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Map Container -->
                <div class="map-container">
                    <div class="map-header">
                        <div class="map-title">Supplier Locations - Visayas Region</div>
                        <div class="map-filters">
                            <button class="filter-btn active" data-category="all">All</button>
                            <button class="filter-btn" data-category="food">Food</button>
                            <button class="filter-btn" data-category="electronics">Electronics</button>
                            <button class="filter-btn" data-category="textile">Textile</button>
                            <button class="filter-btn" data-category="chemicals">Chemicals</button>
                            <button class="filter-btn" data-category="metals">Metals</button>
                        </div>
                    </div>
                    <div class="map-viewport" id="mapViewport">
                        <!-- Interactive Leaflet map will be initialized here -->
                    </div>

                    <!-- Supplier Details Panel -->
                    <div class="supplier-details" id="supplierDetails">
                        <div class="supplier-header">
                            <div class="supplier-name" id="supplierName">Select a supplier</div>
                            <button class="close-details" onclick="closeSupplierDetails()">√ó</button>
                        </div>
                        <div class="supplier-info" id="supplierInfo">
                            <div class="info-row">
                                <span class="info-label">Location:</span>
                                <span class="info-value" id="supplierLocation">-</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Rating:</span>
                                <span class="info-value" id="supplierRating">-</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Lead Time:</span>
                                <span class="info-value" id="supplierLeadTime">-</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Min Order:</span>
                                <span class="info-value" id="supplierMinOrder">-</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Certifications:</span>
                                <span class="info-value" id="supplierCertifications">-</span>
                            </div>
                        </div>
                        <div class="products-supplied">
                            <div class="products-title">Products Supplied:</div>
                            <div id="supplierProducts">
                                <!-- Product tags will be populated -->
                            </div>
                        </div>
                        <button class="contact-btn" onclick="contactSupplier()">Contact Supplier</button>
                        <button class="contact-btn" style="background: #10b981; margin-top: 0.5rem;" onclick="requestQuote()">Request Quote</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script>
        // Enhanced product data with more Visayas-focused suppliers
        const products = [
            { id: 1, name: "Coconut Oil", category: "food", suppliers: ["Cebu Coconut Mills", "Bohol Organic Oils", "Negros Coconut Corp"] },
            { id: 2, name: "Sugarcane Products", category: "food", suppliers: ["Negros Sugar Mill", "Iloilo Sugar Co.", "Dumaguete Sugar Works"] },
            { id: 3, name: "Cotton Fabric", category: "textile", suppliers: ["Cebu Textile Industries", "Iloilo Weaving Co.", "Antique Fabrics Ltd"] },
            { id: 4, name: "Bamboo Materials", category: "construction", suppliers: ["Bohol Bamboo Crafts", "Leyte Bamboo Industries", "Samar Bamboo Co."] },
            { id: 5, name: "Dried Fish Products", category: "food", suppliers: ["Cebu Dried Fish Co.", "Bohol Seafood Processing", "Leyte Marine Products"] },
            { id: 6, name: "Electronic Components", category: "electronics", suppliers: ["Cebu Tech Solutions", "IT Park Electronics", "Mandaue Tech Hub"] },
            { id: 7, name: "Seaweed Extracts", category: "food", suppliers: ["Bohol Seaweed Farm", "Siquijor Marine Products", "Cebu Algae Industries"] },
            { id: 8, name: "Corn Products", category: "food", suppliers: ["Negros Corn Mill", "Leyte Grain Processing", "Samar Agriculture Co."] },
            { id: 9, name: "Rattan Furniture", category: "furniture", suppliers: ["Cebu Rattan Works", "Bohol Furniture Crafts", "Antique Rattan Co."] },
            { id: 10, name: "Copra Products", category: "food", suppliers: ["Leyte Copra Mill", "Samar Coconut Processing", "Biliran Copra Works"] },
            { id: 11, name: "Abaca Fiber", category: "textile", suppliers: ["Leyte Abaca Farm", "Samar Fiber Co.", "Eastern Samar Abaca"] },
            { id: 12, name: "Limestone", category: "construction", suppliers: ["Cebu Quarries Inc.", "Bohol Stone Works", "Negros Limestone Co."] }
        ];

        // Comprehensive Visayas suppliers data with accurate coordinates
        const suppliers = [
            // CEBU PROVINCE
            { id: 1, name: "Cebu Coconut Mills", category: "food", location: "Cebu City, Cebu", province: "Cebu", rating: 4.8, leadTime: 3, minOrder: 25000, products: ["Coconut Oil", "Copra Products"], lat: 10.3157, lng: 123.8854, phone: "+63 32 123 4567", certifications: "HACCP, ISO 22000" },
            { id: 2, name: "Cebu Textile Industries", category: "textile", location: "Mandaue City, Cebu", province: "Cebu", rating: 4.7, leadTime: 7, minOrder: 50000, products: ["Cotton Fabric"], lat: 10.3237, lng: 123.9227, phone: "+63 32 234 5678", certifications: "OEKO-TEX, ISO 9001" },
            { id: 3, name: "Cebu Tech Solutions", category: "electronics", location: "Lahug, Cebu City", province: "Cebu", rating: 4.9, leadTime: 5, minOrder: 75000, products: ["Electronic Components"], lat: 10.3321, lng: 123.9061, phone: "+63 32 345 6789", certifications: "RoHS, CE" },
            { id: 4, name: "Cebu Dried Fish Co.", category: "food", location: "Talisay City, Cebu", province: "Cebu", rating: 4.6, leadTime: 2, minOrder: 15000, products: ["Dried Fish Products"], lat: 10.2449, lng: 123.8495, phone: "+63 32 456 7890", certifications: "FDA, BFAD" },
            { id: 5, name: "Cebu Rattan Works", category: "furniture", location: "Consolacion, Cebu", province: "Cebu", rating: 4.5, leadTime: 14, minOrder: 100000, products: ["Rattan Furniture"], lat: 10.3757, lng: 123.9571, phone: "+63 32 567 8901", certifications: "FSC, ISO 14001" },
            { id: 6, name: "Cebu Quarries Inc.", category: "construction", location: "Carcar City, Cebu", province: "Cebu", rating: 4.4, leadTime: 10, minOrder: 200000, products: ["Limestone"], lat: 10.1077, lng: 123.6386, phone: "+63 32 678 9012", certifications: "DENR, Safety Cert" },

            // BOHOL PROVINCE  
            { id: 7, name: "Bohol Organic Oils", category: "food", location: "Tagbilaran City, Bohol", province: "Bohol", rating: 4.9, leadTime: 4, minOrder: 30000, products: ["Coconut Oil"], lat: 9.6497, lng: 123.8537, phone: "+63 38 123 4567", certifications: "Organic, USDA" },
            { id: 8, name: "Bohol Bamboo Crafts", category: "construction", location: "Carmen, Bohol", province: "Bohol", rating: 4.6, leadTime: 12, minOrder: 80000, products: ["Bamboo Materials"], lat: 9.7024, lng: 124.0154, phone: "+63 38 234 5678", certifications: "Sustainable, ISO 14001" },
            { id: 9, name: "Bohol Seafood Processing", category: "food", location: "Ubay, Bohol", province: "Bohol", rating: 4.7, leadTime: 3, minOrder: 20000, products: ["Dried Fish Products"], lat: 10.0594, lng: 124.4756, phone: "+63 38 345 6789", certifications: "HACCP, FDA" },
            { id: 10, name: "Bohol Seaweed Farm", category: "food", location: "Getafe, Bohol", province: "Bohol", rating: 4.8, leadTime: 5, minOrder: 35000, products: ["Seaweed Extracts"], lat: 9.9547, lng: 124.1458, phone: "+63 38 456 7890", certifications: "Organic, Marine Cert" },
            { id: 11, name: "Bohol Furniture Crafts", category: "furniture", location: "Dauis, Bohol", province: "Bohol", rating: 4.5, leadTime: 16, minOrder: 120000, products: ["Rattan Furniture"], lat: 9.6091, lng: 123.8547, phone: "+63 38 567 8901", certifications: "Handcraft, Export Quality" },
            { id: 12, name: "Bohol Stone Works", category: "construction", location: "Jagna, Bohol", province: "Bohol", rating: 4.3, leadTime: 8, minOrder: 150000, products: ["Limestone"], lat: 9.6504, lng: 124.3637, phone: "+63 38 678 9012", certifications: "Quality Assurance" },

            // NEGROS ORIENTAL
            { id: 13, name: "Dumaguete Sugar Works", category: "food", location: "Dumaguete City, Negros Oriental", province: "Negros Oriental", rating: 4.9, leadTime: 6, minOrder: 100000, products: ["Sugarcane Products"], lat: 9.3063, lng: 123.3019, phone: "+63 35 123 4567", certifications: "Sugar Quality, ISO 9001" },
            { id: 14, name: "Negros Oriental Mills", category: "food", location: "Bais City, Negros Oriental", province: "Negros Oriental", rating: 4.6, leadTime: 5, minOrder: 40000, products: ["Corn Products"], lat: 9.5904, lng: 123.1217, phone: "+63 35 234 5678", certifications: "Grain Quality" },

            // SIQUIJOR
            { id: 15, name: "Siquijor Marine Products", category: "food", location: "Siquijor, Siquijor", province: "Siquijor", rating: 4.7, leadTime: 4, minOrder: 25000, products: ["Seaweed Extracts"], lat: 9.2164, lng: 123.5081, phone: "+63 35 345 6789", certifications: "Marine Sustainable" },

            // NEGROS OCCIDENTAL
            { id: 16, name: "Negros Sugar Mill", category: "food", location: "Bacolod City, Negros Occidental", province: "Negros Occidental", rating: 4.8, leadTime: 7, minOrder: 150000, products: ["Sugarcane Products"], lat: 10.6764, lng: 122.9539, phone: "+63 34 123 4567", certifications: "Premium Sugar, Export Grade" },
            { id: 17, name: "Negros Coconut Corp", category: "food", location: "Silay City, Negros Occidental", province: "Negros Occidental", rating: 4.7, leadTime: 4, minOrder: 45000, products: ["Coconut Oil"], lat: 10.7951, lng: 122.9703, phone: "+63 34 234 5678", certifications: "Virgin Oil, Organic" },
            { id: 18, name: "Negros Corn Mill", category: "food", location: "Talisay City, Negros Occidental", province: "Negros Occidental", rating: 4.5, leadTime: 6, minOrder: 35000, products: ["Corn Products"], lat: 10.7325, lng: 122.9825, phone: "+63 34 345 6789", certifications: "Feed Grade" },
            { id: 19, name: "Negros Limestone Co.", category: "construction", location: "La Carlota City, Negros Occidental", province: "Negros Occidental", rating: 4.4, leadTime: 9, minOrder: 180000, products: ["Limestone"], lat: 10.4219, lng: 122.9242, phone: "+63 34 456 7890", certifications: "Construction Grade" },

            // ILOILO
            { id: 20, name: "Iloilo Sugar Co.", category: "food", location: "Iloilo City, Iloilo", province: "Iloilo", rating: 4.6, leadTime: 8, minOrder: 80000, products: ["Sugarcane Products"], lat: 10.7202, lng: 122.5621, phone: "+63 33 123 4567", certifications: "Raw Sugar, Refined" },
            { id: 21, name: "Iloilo Weaving Co.", category: "textile", location: "Miagao, Iloilo", province: "Iloilo", rating: 4.8, leadTime: 10, minOrder: 60000, products: ["Cotton Fabric"], lat: 10.6438, lng: 121.9234, phone: "+63 33 234 5678", certifications: "Traditional Weave, Export Quality" },

            // AKLAN
            { id: 22, name: "Aklan Textile Mills", category: "textile", location: "Kalibo, Aklan", province: "Aklan", rating: 4.5, leadTime: 9, minOrder: 55000, products: ["Cotton Fabric"], lat: 11.7049, lng: 122.3679, phone: "+63 36 123 4567", certifications: "Pi√±a Fiber, Traditional" },

            // ANTIQUE
            { id: 23, name: "Antique Fabrics Ltd", category: "textile", location: "San Jose, Antique", province: "Antique", rating: 4.4, leadTime: 11, minOrder: 45000, products: ["Cotton Fabric"], lat: 10.7647, lng: 121.9318, phone: "+63 36 234 5678", certifications: "Handwoven, Local Craft" },
            { id: 24, name: "Antique Rattan Co.", category: "furniture", location: "Patnongon, Antique", province: "Antique", rating: 4.6, leadTime: 15, minOrder: 90000, products: ["Rattan Furniture"], lat: 10.9136, lng: 122.1142, phone: "+63 36 345 6789", certifications: "Eco-friendly, Sustainable" },

            // CAPIZ
            { id: 25, name: "Capiz Seafood Processing", category: "food", location: "Roxas City, Capiz", province: "Capiz", rating: 4.7, leadTime: 3, minOrder: 28000, products: ["Dried Fish Products"], lat: 11.5877, lng: 122.7514, phone: "+63 36 456 7890", certifications: "Fresh Quality, HACCP" },

            // GUIMARAS
            { id: 26, name: "Guimaras Fruit Processing", category: "food", location: "Jordan, Guimaras", province: "Guimaras", rating: 4.8, leadTime: 2, minOrder: 20000, products: ["Mango Products"], lat: 10.5803, lng: 122.5711, phone: "+63 33 567 8901", certifications: "Sweet Mangoes, Premium" },

            // LEYTE
            { id: 27, name: "Leyte Marine Products", category: "food", location: "Tacloban City, Leyte", province: "Leyte", rating: 4.6, leadTime: 4, minOrder: 30000, products: ["Dried Fish Products"], lat: 11.2436, lng: 125.0072, phone: "+63 53 123 4567", certifications: "Marine Fresh, Quality" },
            { id: 28, name: "Leyte Bamboo Industries", category: "construction", location: "Ormoc City, Leyte", province: "Leyte", rating: 4.5, leadTime: 13, minOrder: 70000, products: ["Bamboo Materials"], lat: 11.0059, lng: 124.6074, phone: "+63 53 234 5678", certifications: "Sustainable Bamboo" },
            { id: 29, name: "Leyte Copra Mill", category: "food", location: "Baybay City, Leyte", province: "Leyte", rating: 4.4, leadTime: 5, minOrder: 40000, products: ["Copra Products"], lat: 10.6785, lng: 124.8003, phone: "+63 53 345 6789", certifications: "Dried Coconut" },
            { id: 30, name: "Leyte Grain Processing", category: "food", location: "Abuyog, Leyte", province: "Leyte", rating: 4.3, leadTime: 7, minOrder: 50000, products: ["Corn Products"], lat: 10.7482, lng: 125.0121, phone: "+63 53 456 7890", certifications: "Feed Grade Corn" },
            { id: 31, name: "Leyte Abaca Farm", category: "textile", location: "Mahaplag, Leyte", province: "Leyte", rating: 4.7, leadTime: 12, minOrder: 65000, products: ["Abaca Fiber"], lat: 10.5803, lng: 124.9756, phone: "+63 53 567 8901", certifications: "Natural Fiber, Premium" },

            // SOUTHERN LEYTE
            { id: 32, name: "Southern Leyte Copra", category: "food", location: "Maasin City, Southern Leyte", province: "Southern Leyte", rating: 4.5, leadTime: 6, minOrder: 35000, products: ["Copra Products"], lat: 10.1303, lng: 124.8584, phone: "+63 53 678 9012", certifications: "Quality Copra" },

            // SAMAR
            { id: 33, name: "Samar Bamboo Co.", category: "construction", location: "Catbalogan City, Samar", province: "Samar", rating: 4.3, leadTime: 14, minOrder: 60000, products: ["Bamboo Materials"], lat: 11.7756, lng: 124.8817, phone: "+63 55 123 4567", certifications: "Native Bamboo" },
            { id: 34, name: "Samar Agriculture Co.", category: "food", location: "Calbayog City, Samar", province: "Samar", rating: 4.4, leadTime: 8, minOrder: 45000, products: ["Corn Products"], lat: 12.0664, lng: 124.6045, phone: "+63 55 234 5678", certifications: "Agricultural Grade" },
            { id: 35, name: "Samar Coconut Processing", category: "food", location: "Basey, Samar", province: "Samar", rating: 4.5, leadTime: 5, minOrder: 38000, products: ["Copra Products"], lat: 11.2758, lng: 125.0636, phone: "+63 55 345 6789", certifications: "Traditional Processing" },
            { id: 36, name: "Samar Fiber Co.", category: "textile", location: "Gandara, Samar", province: "Samar", rating: 4.6, leadTime: 11, minOrder: 55000, products: ["Abaca Fiber"], lat: 12.0156, lng: 124.8369, phone: "+63 55 456 7890", certifications: "Strong Fiber, Export" },

            // EASTERN SAMAR
            { id: 37, name: "Eastern Samar Abaca", category: "textile", location: "Borongan City, Eastern Samar", province: "Eastern Samar", rating: 4.7, leadTime: 10, minOrder: 60000, products: ["Abaca Fiber"], lat: 11.6050, lng: 125.4336, phone: "+63 55 567 8901", certifications: "Premium Abaca, Strong" },

            // NORTHERN SAMAR
            { id: 38, name: "Northern Samar Marine", category: "food", location: "Catarman, Northern Samar", province: "Northern Samar", rating: 4.4, leadTime: 4, minOrder: 32000, products: ["Dried Fish Products"], lat: 12.4994, lng: 124.6378, phone: "+63 55 678 9012", certifications: "Fresh Marine" },

            // BILIRAN
            { id: 39, name: "Biliran Copra Works", category: "food", location: "Naval, Biliran", province: "Biliran", rating: 4.6, leadTime: 4, minOrder: 30000, products: ["Copra Products"], lat: 11.5554, lng: 124.3928, phone: "+63 53 789 0123", certifications: "Island Fresh Copra" }
        ];

        let selectedProduct = null;
        let filteredSuppliers = suppliers;
        let map = null;
        let markersGroup = null;
        let currentSupplier = null;

        // Category colors for map markers
        const categoryColors = {
            food: '#10b981',
            electronics: '#f59e0b', 
            textile: '#8b5cf6',
            chemicals: '#ef4444',
            metals: '#6b7280',
            construction: '#0ea5e9',
            furniture: '#ec4899'
        };

        // Update time every second
        function updateTime() {
            const now = new Date();
            const options = {
                timeZone: 'Asia/Manila',
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            const timeString = now.toLocaleString('en-US', options);
            document.getElementById('current-time').textContent = timeString;
        }

        // Initialize the application
        function initApp() {
            initMap();
            populateProductList();
            setupEventListeners();
            renderMapMarkers();
        }

        // Initialize Leaflet map focused on Visayas
        function initMap() {
            map = L.map('mapViewport').setView([10.5, 123.5], 8);
            
            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);

            // Initialize markers group
            markersGroup = L.layerGroup().addTo(map);

            // Add Visayas region boundary highlight (approximate)
            const visayasBounds = [
                [8.5, 121.0],  // Southwest
                [13.5, 126.5]  // Northeast
            ];
            
            // Optional: Add a subtle region highlight
            const visayasHighlight = L.rectangle(visayasBounds, {
                color: '#4f46e5',
                weight: 2,
                opacity: 0.3,
                fillOpacity: 0.1
            }).addTo(map);
        }

        // Render suppliers as map markers
        function renderMapMarkers() {
            markersGroup.clearLayers();

            filteredSuppliers.forEach(supplier => {
                const color = categoryColors[supplier.category] || '#6b7280';
                
                // Create custom icon
                const customIcon = L.divIcon({
                    className: 'custom-marker',
                    html: `<div style="
                        background: ${color};
                        width: 24px;
                        height: 24px;
                        border-radius: 50%;
                        border: 3px solid white;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                        font-size: 12px;
                        font-weight: bold;
                    ">${supplier.name.charAt(0)}</div>`,
                    iconSize: [24, 24],
                    iconAnchor: [12, 12]
                });

                const marker = L.marker([supplier.lat, supplier.lng], { icon: customIcon })
                    .bindPopup(`
                        <div class="supplier-popup">
                            <div class="popup-header">${supplier.name}</div>
                            <div class="popup-info">üìç ${supplier.location}</div>
                            <div class="popup-info">üì± ${supplier.phone}</div>
                            <div class="popup-rating">‚≠ê ${supplier.rating}/5</div>
                            <div class="popup-info">‚è±Ô∏è ${supplier.leadTime} days lead time</div>
                            <div class="popup-info">üí∞ Min order: ‚Ç±${supplier.minOrder.toLocaleString()}</div>
                            <button class="popup-btn" onclick="showSupplierDetails(${supplier.id})">View Details</button>
                        </div>
                    `);

                marker.on('click', () => showSupplierDetails(supplier.id));
                markersGroup.addLayer(marker);
            });
        }

        // Populate product list
        function populateProductList() {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';

            // Apply current filters
            let displayProducts = products;
            const searchTerm = document.getElementById('productSearch').value.toLowerCase();
            
            if (searchTerm) {
                displayProducts = products.filter(product =>
                    product.name.toLowerCase().includes(searchTerm) ||
                    product.category.toLowerCase().includes(searchTerm)
                );
            }

            displayProducts.forEach(product => {
                const availableSuppliers = suppliers.filter(supplier =>
                    supplier.products.some(p => product.suppliers.includes(supplier.name))
                );

                const productItem = document.createElement('div');
                productItem.className = 'product-item';
                productItem.dataset.productId = product.id;
                productItem.innerHTML = `
                    <div class="product-name">${product.name}</div>
                    <div class="product-category">${product.category.charAt(0).toUpperCase() + product.category.slice(1)}</div>
                    <div class="product-suppliers">${availableSuppliers.length} suppliers available</div>
                `;
                productItem.addEventListener('click', () => selectProduct(product.id));
                productList.appendChild(productItem);
            });
        }

        // Select product and filter suppliers
        function selectProduct(productId) {
            selectedProduct = productId;
            const product = products.find(p => p.id === productId);

            // Update active state
            document.querySelectorAll('.product-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.productId == productId) {
                    item.classList.add('active');
                }
            });

            // Filter suppliers based on selected product
            applyFilters();
        }

        // Apply all filters
        function applyFilters() {
            let filtered = suppliers;

            // Product filter
            if (selectedProduct) {
                const product = products.find(p => p.id === selectedProduct);
                filtered = filtered.filter(supplier =>
                    supplier.products.some(p => product.suppliers.includes(supplier.name))
                );
            }

            // Category filter
            const activeCategory = document.querySelector('.filter-btn.active').dataset.category;
            if (activeCategory !== 'all') {
                filtered = filtered.filter(supplier => supplier.category === activeCategory);
            }

            // Province filter
            const provinceFilter = document.getElementById('provinceFilter').value;
            if (provinceFilter) {
                filtered = filtered.filter(supplier => supplier.province === provinceFilter);
            }

            // Rating filter
            const ratingFilter = document.getElementById('ratingFilter').value;
            if (ratingFilter) {
                filtered = filtered.filter(supplier => supplier.rating >= parseFloat(ratingFilter));
            }

            // Lead time filter
            const minLeadTime = document.getElementById('minLeadTime').value;
            const maxLeadTime = document.getElementById('maxLeadTime').value;
            if (minLeadTime) {
                filtered = filtered.filter(supplier => supplier.leadTime >= parseInt(minLeadTime));
            }
            if (maxLeadTime) {
                filtered = filtered.filter(supplier => supplier.leadTime <= parseInt(maxLeadTime));
            }

            filteredSuppliers = filtered;
            renderMapMarkers();
            updateStats();
        }

        // Update statistics
        function updateStats() {
            const statCards = document.querySelectorAll('.stat-card .stat-value');
            if (statCards.length >= 4) {
                statCards[0].textContent = filteredSuppliers.length;
                
                const categories = [...new Set(filteredSuppliers.map(s => s.category))];
                statCards[1].textContent = categories.length;
                
                const avgRating = filteredSuppliers.length > 0 
                    ? (filteredSuppliers.reduce((sum, s) => sum + s.rating, 0) / filteredSuppliers.length * 100 / 5).toFixed(0)
                    : 0;
                statCards[2].textContent = `${avgRating}%`;
                
                const totalMinOrders = filteredSuppliers.reduce((sum, s) => sum + s.minOrder, 0);
                statCards[3].textContent = `‚Ç±${(totalMinOrders / 1000000).toFixed(1)}M`;
            }
        }

        // Show supplier details
        function showSupplierDetails(supplierId) {
            const supplier = suppliers.find(s => s.id === supplierId);
            if (!supplier) return;

            currentSupplier = supplier;

            document.getElementById('supplierName').textContent = supplier.name;
            document.getElementById('supplierLocation').textContent = supplier.location;
            document.getElementById('supplierLeadTime').textContent = `${supplier.leadTime} days`;
            document.getElementById('supplierMinOrder').textContent = `‚Ç±${supplier.minOrder.toLocaleString()}`;
            document.getElementById('supplierCertifications').textContent = supplier.certifications;

            // Create rating stars
            const ratingElement = document.getElementById('supplierRating');
            const fullStars = Math.floor(supplier.rating);
            const hasHalfStar = supplier.rating % 1 !== 0;
            const emptyStars = 5 - Math.ceil(supplier.rating);
            
            ratingElement.innerHTML = `${supplier.rating}/5 ${'‚≠ê'.repeat(fullStars)}${hasHalfStar ? '‚≠ê' : ''}${'‚òÜ'.repeat(emptyStars)}`;

            // Populate products
            const productsContainer = document.getElementById('supplierProducts');
            productsContainer.innerHTML = '';
            supplier.products.forEach(product => {
                const tag = document.createElement('span');
                tag.className = 'product-tag';
                tag.textContent = product;
                productsContainer.appendChild(tag);
            });

            // Show the details panel
            document.getElementById('supplierDetails').classList.add('active');

            // Center map on supplier
            map.setView([supplier.lat, supplier.lng], 12);
        }

        // Close supplier details
        function closeSupplierDetails() {
            document.getElementById('supplierDetails').classList.remove('active');
            currentSupplier = null;
        }

        // Contact supplier
        function contactSupplier() {
            if (currentSupplier) {
                const message = `Hello ${currentSupplier.name},\n\nI'm interested in your products and would like to discuss potential business opportunities.\n\nBest regards,\nBusiness Hub User`;
                
                // Create mailto link
                const mailtoLink = `mailto:${currentSupplier.phone.replace('+63', 'info@')}@${currentSupplier.name.toLowerCase().replace(/\s+/g, '')}.com?subject=Business Inquiry&body=${encodeURIComponent(message)}`;
                
                // Show contact options
                const contactModal = confirm(`Contact ${currentSupplier.name}?\n\nPhone: ${currentSupplier.phone}\nEmail: Auto-generated\n\nClick OK to open email client or Cancel to copy phone number.`);
                
                if (contactModal) {
                    window.location.href = mailtoLink;
                } else {
                    navigator.clipboard.writeText(currentSupplier.phone).then(() => {
                        alert('Phone number copied to clipboard!');
                    });
                }
            }
        }

        // Request quote
        function requestQuote() {
            if (currentSupplier) {
                const productName = selectedProduct ? products.find(p => p.id === selectedProduct)?.name : 'Various Products';
                const quantity = prompt(`Request quote from ${currentSupplier.name}\n\nProduct: ${productName}\nMin Order: ‚Ç±${currentSupplier.minOrder.toLocaleString()}\n\nEnter desired quantity (in PHP value):`);
                
                if (quantity && !isNaN(quantity)) {
                    const quoteAmount = parseInt(quantity);
                    if (quoteAmount >= currentSupplier.minOrder) {
                        alert(`Quote request sent to ${currentSupplier.name}!\n\nProduct: ${productName}\nQuantity: ‚Ç±${quoteAmount.toLocaleString()}\nEstimated delivery: ${currentSupplier.leadTime} days\n\nYou will receive a response within 24 hours.`);
                    } else {
                        alert(`Minimum order amount is ‚Ç±${currentSupplier.minOrder.toLocaleString()}. Please enter a higher amount.`);
                    }
                }
            }
        }

        // Filter by category
        function filterByCategory(category) {
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.category === category) {
                    btn.classList.add('active');
                }
            });

            applyFilters();
        }

        // Search products
        function searchProducts() {
            populateProductList();
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search input
            document.getElementById('productSearch').addEventListener('input', searchProducts);

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    filterByCategory(btn.dataset.category);
                });
            });

            // Advanced filter controls
            document.getElementById('provinceFilter').addEventListener('change', applyFilters);
            document.getElementById('ratingFilter').addEventListener('change', applyFilters);
            document.getElementById('minLeadTime').addEventListener('input', applyFilters);
            document.getElementById('maxLeadTime').addEventListener('input', applyFilters);

            // Close details panel when clicking on map
            map.on('click', (e) => {
                // Only close if clicking on map, not on markers
                closeSupplierDetails();
            });
        }

        // Initialize app when page loads
        window.addEventListener('load', () => {
            updateTime();
            setInterval(updateTime, 1000);
            initApp();
        });

        // Global functions for onclick handlers
        window.showSupplierDetails = (supplierId) => showSupplierDetails(supplierId);
        window.closeSupplierDetails = closeSupplierDetails;
        window.contactSupplier = contactSupplier;
        window.requestQuote = requestQuote;
    </script>
</body>

</html>